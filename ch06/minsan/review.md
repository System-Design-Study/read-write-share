이번 장에서는 키-값 분산 저장소를 설계하는 과정을 살펴보았다.

앞의 5장에서 살펴본 안정 해시의 내용이 많이 포함되어 있어서, 관련 내용을 다루는 곳에서는 읽는 데 큰 어려움은 없었지만 생소한 부분들이 많아서 조금 어렵게 느껴지기도 했다.

이번 장은 `일관성`과 `가용성` 사이에서 **어떤 기준으로 트레이드오프**를 해야하며, **`일관성 수준`은 어떻게 조절할 수 있는지**를 중심으로 이해하면 좋을 것 같다.

# CAP 정리 - 분산 시스템 설계

분산 시스템을 설계할 경우, CAP 정리에 대해서 이해하고 이를 기반으로 요구사항에 적합한 시스템을 선택해야 한다.

특히 네트워크 장애는 현실에서 피할 수 없는 문제이기 때문에, **파티션 감내**를 고려한 상태에서 `가용성`과 `일관성`의 트레이드오프가 필요하다. _(CP vs AP)_

- 가령 은행 시스템처럼 일관성이 중요한 서비스에서는 가용성을 일부 포기하는 **CP 시스템**을 설계하는 것이 적합하다. _(일부 노드에 문제가 발생하면 시스템 중단)_

# 정족수 합의 프로토콜 - 데이터 일관성 조절

읽기 / 쓰기에 대해서 정족수 합의 수를 조절함으로써 데이터의 일관성 수준을 조절할 수 있다.

- 정족수가 많아질수록 일관성은 높아지지만, 그만큼 가용성은 낮아진다.

예를들어 빠른 읽기를 제공하되 쓰기 연산에서는 높은 일관성을 보장하고자 하는 경우에는 `R` 값은 1로, `W` 값은 서버 노드의 수로 설정할 수 있다.
